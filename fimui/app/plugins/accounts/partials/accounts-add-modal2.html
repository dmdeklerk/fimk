<div class="modal-header">
  <h4 class="modal-title">{{dialogTitle}}</h4>
</div>
<div class="modal-body">

  <!-- Start screen -->
  <div ng-if="state == 0 || state === undefined">
    <div class="well"><p><center>You can create a new account or add an existing account. To add an existing account all you need is an account number.</center></p></div>
    <br>
    <div class="form-group">
      <div class="col-xs-6">
        <button class="btn btn-block btn-success" ng-click="setState(1)" type="button">Create New</button>
      </div>
      <div class="col-xs-6">
        <button class="btn btn-block btn-warn" ng-click="setState(6)" type="button">Add Existing</button>
      </div>
    </div>
    <div class="form-group"><br><br></div>
    <div class="modal-footer">
      <div class="form-group">
        <div class="col-xs-6 col-xs-offset-3">
          <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
        </div>
      </div>      
    </div>  
  </div>  

  <!-- Generate secret phrase -->
  <div ng-if="state == 1">
    <form accept-charset="UTF-8" role="form" name="accountGenerateSecretphraseForm" class="form-horizontal" novalidate>
      <div ng-if="mouseRandom && !mouseRandomDone">
        <div class="well"><p><center>In order to create the secretphrase to access your FIM account we need to gather some random data.</center></p><p><center>Please keep moving your mouse until the progressbar is full.</center></p></div>
        <div class="progress">
          <progressbar max="100" value="mouseRandomPercent">{{mouseRandomPercent}}%</progressbar>
        </div>
      </div>
      <div ng-if="!mouseRandom || mouseRandomDone">
        <div class="well"><center>Please write down or memorize these 12 words (their order and capitalization matters). This secret phrase is needed in order to access your FIM account.</center></div>
        <div>
          <textarea rows="2" class="form-control monospace" readonly id="accounts-plugin-secretPhrase">{{items.secretPhrase}}</textarea>
          <a href class="pull-right" ng-click="generateSecretPhrase()">Generate a different secretphrase</a>
        </div>
        <div><br></div>
        <div class="form-group">
          <center><h3><strong>{{items.id_rs}}</strong></h3></center>
        </div>
        <div><br></div>
        <div class="modal-footer">
          <div class="form-group back-next-group">
            <div class="col-xs-3">
              <button class="btn btn-block btn-info" ng-click="setState(0)" type="button">Back</button>
            </div>
            <div class="col-xs-3">
              <button class="btn btn-block btn-info" ng-click="setState(2)" type="button"><strong>Next</strong></button>
            </div>
            <div class="col-xs-6">
              <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- Confirm secretPhrase -->
  <div ng-if="state == 2">
    <form accept-charset="UTF-8" role="form" name="accountConfirmSecretphraseForm" class="form-horizontal" novalidate>
      <div class="well"><p><center><strong>Your secret phrase is very important!</strong></center></p><p><center>In order to be sure that you have saved it, please write your secret phrase below.</center></p></div>
      <textarea rows="2" class="form-control monospace" required ui-validate=" '$value==items.secretPhrase' " 
        ng-model="confirm_password" ui-validate-watch=" 'items.secretPhrase' " name="confirm_password"></textarea>
      <div><br></div>
      <div class="modal-footer">
        <div class="form-group back-next-group">
          <div class="col-xs-3">
            <button class="btn btn-block btn-info" type="button" ng-click="setState(1)">Back</button>
          </div>
          <div class="col-xs-3">
            <button class="btn btn-block btn-info" ng-click="setState(3)" type="button" ng-disabled="!accountConfirmSecretphraseForm.$valid">
              <strong>Next</strong>
            </button>
          </div>
          <div class="col-xs-6">
            <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- Choose public key publish method -->
  <div ng-if="state == 3">
    <form accept-charset="UTF-8" role="form" name="accountChoosePublishKeyForm" class="form-horizontal" novalidate>
      <div class="well"><p><center><strong>You must publish your public key on the blockchain.</strong></center></p><p><center>Please select how you want to publish your public key.</center></p></div>
      <div class="form-group">
        <center>
          <strong>
            <!-- After this we switch to state  -->
            <a href ng-click="publishAndFundAccount()">Publish the public key yourself (costs 0.1 FIM)</a>
          </strong>
        </center>
      </div>
      <br>
      <div class="form-group">
        <center>
          <strong>
            <a href ng-click="setState(5)">Generate deposit+publish address</a>
          </strong>
        </center>
      </div>
      <div><br></div>
      <div class="modal-footer">
        <div class="form-group back-next-group">
          <div class="col-xs-3">
            <button class="btn btn-block btn-info" type="button" ng-click="setState(2)">Back</button>
          </div>
          <div class="col-xs-3">
            <button class="btn btn-block btn-info" type="button" disabled><strong>Next</strong></button>
          </div>
          <div class="col-xs-6">
            <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- Self publish success -->
  <div ng-if="state == 4">
    <form accept-charset="UTF-8" role="form" name="accountPublishSuccessForm" class="form-horizontal" novalidate>
      <div class="well"><p><center><strong>Congratulations!</strong></center></p><p><center>You have successfully published your public key in the blockchain. After one block (that's 30 seconds in FIM) you can start using your new account.</center></p><p><center>FIM Community Client can remember this account for you if you enter a name for this account. The name can be changed later.<p><center><strong>Be sure to NEVER loose your 12 word secretphrase!</strong></center></p></div>
      <div class="alert alert-danger" role="alert"  ng-show="safeAccountError">{{safeAccountError}}</div>
      <div class="alert alert-danger" role="alert"  ng-show="!!accountPublishSuccessForm.name.$error.duplicate">That name already exists</div>
      <div class="form-group">
        <label for="account-name-3" class="control-label col-xs-2">Name</label>
        <div class="col-xs-10">
          <input class="form-control" id="account-name-3" type="text" ng-model="items.name" required 
            ui-validate="{duplicate : 'nameIsUnique($value)' }" ui-validate-watch=" 'items.name' " name="name">
        </div>
      </div>
    </form>
    <div><br></div>
    <div class="modal-footer">
      <div class="form-group back-next-group">
        <div class="col-xs-6">
          <button class="btn btn-block btn-success" ng-click="close()" type="button" ng-disabled="!accountPublishSuccessForm.$valid">Save</button>
        </div>
        <div class="col-xs-6">
          <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
        </div>
      </div>
    </div>    
  </div>  

  <!-- Deposit+Publish address -->
  <div ng-if="state == 5">
    <form accept-charset="UTF-8" role="form" name="accountPublishDepositAddressForm" class="form-horizontal" novalidate>
      <div class="well"><p><center><strong>You must publish your public key on the blockchain.</strong></center></p><p><center>Since your public key is not yet published you <strong>MUST</strong> use the address displayed below for your first transaction. <strong>AFTER</strong> you received your first transaction on this address you can from then on use the shorter address that does not include the public key.</center></p><p><center>FIM Community Client can store this account in it's database if you enter a name for it.</center></p></div>
      <div>
        <textarea style="margin-bottom: 10px" rows="3" class="form-control monospace col-xs-12" readonly name="deposit_publish" ng-model="items.publishAddress"></textarea>
      </div>
      <div class="alert alert-warning" role="alert"  ng-show="!!accountPublishDepositAddressForm.name.$error.duplicate">That name already exists</div>
      <div class="form-group">
        <label for="account-name-5" class="control-label col-xs-2">Name</label>
        <div class="col-xs-10">
          <input class="form-control" id="account-name-5" type="text" ng-model="items.name" required 
            ui-validate="{duplicate : 'nameIsUnique($value)' }" ui-validate-watch=" 'items.name' " name="name">
        </div>
      </div>
    </form>
    <div><br></div>
    <div class="modal-footer">
      <div class="form-group back-next-group">
        <div class="col-xs-6">
          <button class="btn btn-block btn-success" ng-click="close()" type="button" 
            ng-disabled="!accountPublishDepositAddressForm.$valid">Save</button>
        </div>
        <div class="col-xs-6">
          <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add existing account -->  
  <div ng-if="state == 6">
    <form accept-charset="UTF-8" role="form" name="accountAddExistingForm" class="form-horizontal" novalidate>
      <div class="well"><p><center><strong>Add an existing account</strong></center></p><p><center>Please enter an existing account and a name. The name is used only in your local copy of FIM Community Client.</center></p></div>
      <div class="alert alert-warning" role="alert"  ng-show="!!accountAddExistingForm.id_rs.$error.duplicate">That account already exists</div>
      <div class="alert alert-warning" role="alert"  ng-show="!!accountAddExistingForm.id_rs.$error.invalid">That is not a valid FIM address</div>
      <div class="alert alert-warning" role="alert"  ng-show="!!accountAddExistingForm.name.$error.duplicate">That name already exists</div>
      <div class="form-group">
        <label for="account-account-1" class="control-label col-xs-2">Account</label>
        <div class="col-xs-10">
          <input class="form-control" id="account-account-1" type="text" ng-model="items.id_rs" required 
            ui-validate="{duplicate : 'idIsUnique($value)', invalid : 'isValidID($value)' }" ui-validate-watch=" 'items.id_rs' " 
            name="id_rs" ng-change="fetchPublicKey()">
        </div>
      </div>
      <div class="form-group" ng-show="items.id_rs">
        <label for="account-pubkey-2" class="control-label col-xs-2">Publickey</label>
        <div class="col-xs-10">
          <input class="form-control" id="account-pubkey-2" type="text" ng-model="items.publicKey" required name="publicKey">
        </div>
      </div>
      <div class="form-group">
        <label for="account-name-4" class="control-label col-xs-2">Name</label>
        <div class="col-xs-10">
          <input class="form-control" id="account-name-4" type="text" ng-model="items.name" required 
            ui-validate="{duplicate : 'nameIsUnique($value)' }" ui-validate-watch=" 'items.name' " name="name">
        </div>
      </div>
      <div><br></div>
      <div class="modal-footer">
        <div class="form-group back-next-group">
          <div class="col-xs-6">
            <button class="btn btn-block btn-success" ng-click="close()" type="button" ng-disabled="!accountAddExistingForm.$valid">Save</button>
          </div>
          <div class="col-xs-6">
            <button class="btn btn-block btn-warning" ng-click="dismiss()" type="button">Cancel</button>
          </div>
        </div>
      </div>
    </form>
  </div>


 
</div>